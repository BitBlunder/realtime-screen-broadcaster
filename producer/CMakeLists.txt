cmake_minimum_required (VERSION 3.30)
project (screen-broadcaster VERSION 0.1.0 LANGUAGES CXX)

set (BUILD_SHARED_LIBS OFF)

set (CMAKE_CXX_STANDARD 17)
set (CMAKE_CXX_STANDARD_REQUIRED ON)

set (CMAKE_ARCHIVE_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/lib")
set (CMAKE_LIBRARY_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/bin")
set (CMAKE_RUNTIME_OUTPUT_DIRECTORY "${CMAKE_BINARY_DIR}/bin")

set (SB_VERSION_MAJOR ${PROJECT_VERSION_MAJOR} CACHE INTERNAL "")
set (SB_VERSION_MINOR ${PROJECT_VERSION_MINOR} CACHE INTERNAL "")
set (SB_VERSION_PATCH ${PROJECT_VERSION_PATCH} CACHE INTERNAL "")

set (ENABLE_ACL     OFF CACHE BOOL "" FORCE)
set (ENABLE_TAR     OFF CACHE BOOL "" FORCE)
set (ENABLE_CAT     OFF CACHE BOOL "" FORCE)
set (ENABLE_LZMA    ON  CACHE BOOL "" FORCE)
set (ENABLE_CPIO    OFF CACHE BOOL "" FORCE)
set (ENABLE_TEST    OFF CACHE BOOL "" FORCE)
set (ENABLE_XATTR   OFF CACHE BOOL "" FORCE)
set (ENABLE_ICONV   OFF CACHE BOOL "" FORCE)
set (ENABLE_OPENSSL OFF CACHE BOOL "" FORCE)

set (LIBARCHIVE_INSTALL OFF CACHE BOOL "" FORCE)

set(ZLIB_ROOT        "C:/My Programs/Development/MinGW/opt")
set(OPENSSL_ROOT_DIR "C:/My Programs/Development/MinGW/opt")
set(LIBLZMA_ROOT_DIR "C:/My Programs/Development/MinGW/opt")

set(ZLIB_LIBRARY        "${ZLIB_ROOT}/lib/libz.a")
set(ZLIB_INCLUDE_DIR    "${ZLIB_ROOT}/include")

set(LIBLZMA_LIBRARY     "${LIBLZMA_ROOT_DIR}/lib/liblzma.a")
set(LIBLZMA_INCLUDE_DIR "${LIBLZMA_ROOT_DIR}/include")

set(OPENSSL_SSL_LIBRARY    "${OPENSSL_ROOT_DIR}/lib/libssl.a")
set(OPENSSL_CRYPTO_LIBRARY "${OPENSSL_ROOT_DIR}/lib/libcrypto.a")
set(OPENSSL_INCLUDE_DIR    "${OPENSSL_ROOT_DIR}/include/openssl")

option (LOG_ENABLED "Enables logging." ON)
option (LOG_ATTACH_CONSOLE "Enables console logging." ON)

add_subdirectory(external/libarchive)

add_subdirectory(common)
add_subdirectory(dropper)
add_subdirectory(recorder)